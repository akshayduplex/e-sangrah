<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Preview</title>
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            height: 100%;
        }

        iframe,
        img {
            display: block;
            width: 100%;
            height: 100%;
            border: none;
        }

        img {
            object-fit: contain;
        }
    </style>
</head>

<body>
    <% if (!file) { %>
        <p style="text-align:center; padding:20px;">File not found.</p>
        <% } else { %>

            <% if (file.fileType.isPDF) { %>
                <!-- PDF Viewer -->
                <iframe src="/api/file/pdf/<%= file._id %>"></iframe>

                <% } else if (['png','jpg','jpeg','gif'].includes(file.fileType.extension)) { %>
                    <!-- Image Preview -->
                    <img src="<%= file.fileUrl %>" alt="<%= file.originalName %>" />

                    <% } else if (file.fileType.isWord || file.fileType.isExcel || file.fileType.isPowerPoint) { %>
                        <!-- Office Preview -->
                        <iframe
                            src="https://view.officeapps.live.com/op/embed.aspx?src=<%= encodeURIComponent(file.fileUrl) %>"></iframe>

                        <% } else { %>
                            <!-- Other file types -->
                            <p style="text-align:center; padding:20px;">
                                Download file:
                                <a href="/api/download/file/<%= file._id %>" target="_blank">Click here</a>
                            </p>
                            <% } %>

                                <% } %>
</body>

</html>