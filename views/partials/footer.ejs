<!-- Add Todo -->
<div class="modal fade" id="add_todo">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Add New Todo</h4>
                <button type="button" class="btn-close custom-btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <i class="ti ti-x"></i>
                </button>
            </div>
            <form action="https://smarthr.co.in/demo/html/template/index.html">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-12">
                            <div class="mb-3">
                                <label class="form-label">Todo Title</label>
                                <input type="text" class="form-control">
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="mb-3">
                                <label class="form-label">Tag</label>
                                <select class="select">
                                    <option>Select</option>
                                    <option>Internal</option>
                                    <option>Projects</option>
                                    <option>Meetings</option>
                                    <option>Reminder</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="mb-3">
                                <label class="form-label">Priority</label>
                                <select class="select">
                                    <option>Select</option>
                                    <option>Medium</option>
                                    <option>High</option>
                                    <option>Low</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-lg-12">
                            <div class="mb-3">
                                <label class="form-label">Descriptions</label>
                                <div class="summernote"></div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="mb-3">
                                <label class="form-label">Add Assignee</label>
                                <select class="select">
                                    <option>Select</option>
                                    <option>Sophie</option>
                                    <option>Cameron</option>
                                    <option>Doris</option>
                                    <option>Rufana</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="mb-0">
                                <label class="form-label">Status</label>
                                <select class="select">
                                    <option>Select</option>
                                    <option>Completed</option>
                                    <option>Pending</option>
                                    <option>Onhold</option>
                                    <option>Inprogress</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light me-2" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add New Todo</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- /Add Todo -->

<!-- Add Project -->
<div class="modal fade" id="add_project" role="dialog">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header header-border align-items-center justify-content-between">
                <div class="d-flex align-items-center">
                    <h5 class="modal-title me-2">Add Project </h5>
                    <p class="text-dark">Project ID : PRO-0004</p>
                </div>
                <button type="button" class="btn-close custom-btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <i class="ti ti-x"></i>
                </button>
            </div>
            <div class="add-info-fieldset">
                <div class="add-details-wizard p-3 pb-0">
                    <ul class="progress-bar-wizard d-flex align-items-center border-bottom">
                        <li class="active p-2 pt-0">
                            <h6 class="fw-medium">Basic Information</h6>
                        </li>
                        <li class="p-2 pt-0">
                            <h6 class="fw-medium">Members</h6>
                        </li>
                    </ul>
                </div>
                <fieldset id="first-field-file">
                    <form action="https://smarthr.co.in/demo/html/template/projects.html">
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-12">
                                    <div
                                        class="d-flex align-items-center flex-wrap row-gap-3 bg-light w-100 rounded p-3 mb-4">
                                        <div
                                            class="d-flex align-items-center justify-content-center avatar avatar-xxl rounded-circle border border-dashed me-2 flex-shrink-0 text-dark frames">
                                            <i class="ti ti-photo text-gray-2 fs-16"></i>
                                        </div>
                                        <div class="profile-upload">
                                            <div class="mb-2">
                                                <h6 class="mb-1">Upload Project Logo</h6>
                                                <p class="fs-12">Image should be below 4 mb</p>
                                            </div>
                                            <div class="profile-uploader d-flex align-items-center">
                                                <div class="drag-upload-btn btn btn-sm btn-primary me-2">
                                                    Upload
                                                    <input type="file" class="form-control image-sign" multiple="">
                                                </div>
                                                <a href="javascript:void(0);" class="btn btn-light btn-sm">Cancel</a>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label class="form-label">Project Name</label>
                                        <input type="text" class="form-control">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label class="form-label">Client</label>
                                        <select class="select">
                                            <option>Select</option>
                                            <option>Anthony Lewis</option>
                                            <option>Brian Villalobos</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Start Date</label>
                                                <div class="input-icon-end position-relative">
                                                    <input type="text" class="form-control datetimepicker"
                                                        placeholder="dd/mm/yyyy" value="02-05-2024">
                                                    <span class="input-icon-addon">
                                                        <i class="ti ti-calendar text-gray-7"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">End Date</label>
                                                <div class="input-icon-end position-relative">
                                                    <input type="text" class="form-control datetimepicker"
                                                        placeholder="dd/mm/yyyy" value="02-05-2024">
                                                    <span class="input-icon-addon">
                                                        <i class="ti ti-calendar text-gray-7"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Priority</label>
                                                <select class="select">
                                                    <option>Select</option>
                                                    <option>High</option>
                                                    <option>Medium</option>
                                                    <option>Low</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Project Value</label>
                                                <input type="text" class="form-control" value="$">
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Total Working Hours</label>
                                                <div class="input-icon-end position-relative">
                                                    <input type="text" class="form-control timepicker"
                                                        placeholder="-- : -- : --" value="02-05-2024">
                                                    <span class="input-icon-addon">
                                                        <i class="ti ti-clock-hour-3 text-gray-7"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Extra Time</label>
                                                <input type="text" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="mb-0">
                                        <label class="form-label">Description</label>
                                        <div class="summernote"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="d-flex align-items-center justify-content-end">
                                <button type="button" class="btn btn-outline-light border me-2"
                                    data-bs-dismiss="modal">Cancel</button>
                                <button class="btn btn-primary wizard-next-btn" type="button">Add Team Member</button>
                            </div>
                        </div>
                    </form>
                </fieldset>
                <fieldset>
                    <form action="https://smarthr.co.in/demo/html/template/projects.html">
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label class="form-label me-2">Team Members</label>
                                        <input class="input-tags form-control" placeholder="Add new" type="text"
                                            data-role="tagsinput" name="Label" value="Jerald,Andrew,Philip,Davis">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label class="form-label me-2">Team Leader</label>
                                        <input class="input-tags form-control" placeholder="Add new" type="text"
                                            data-role="tagsinput" name="Label" value="Hendry,James">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label class="form-label me-2">Project Manager</label>
                                        <input class="input-tags form-control" placeholder="Add new" type="text"
                                            data-role="tagsinput" name="Label" value="Dwight">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div class="mb-3">
                                        <label class="form-label">Status</label>
                                        <select class="select">
                                            <option>Select</option>
                                            <option>Active</option>
                                            <option>Inactive</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <div>
                                        <label class="form-label">Tags</label>
                                        <select class="select">
                                            <option>Select</option>
                                            <option>High</option>
                                            <option>Low</option>
                                            <option>Medium</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="d-flex align-items-center justify-content-end">
                                <button type="button" class="btn btn-outline-light border me-2"
                                    data-bs-dismiss="modal">Cancel</button>
                                <button class="btn btn-primary" type="button" data-bs-toggle="modal"
                                    data-bs-target="#success_modal">Save</button>
                            </div>
                        </div>
                    </form>
                </fieldset>
            </div>
        </div>
    </div>
</div>
<!-- /Add Project -->

<!-- Add Leaves -->
<div class="modal fade" id="add_leaves">
    <div class="modal-dialog modal-dialog-centered modal-md">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Add Leave Request</h4>
                <button type="button" class="btn-close custom-btn-close" data-bs-dismiss="modal" aria-label="Close">
                    <i class="ti ti-x"></i>
                </button>
            </div>
            <form action="https://smarthr.co.in/demo/html/template/index.html">
                <div class="modal-body pb-0">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="mb-3">
                                <label class="form-label">Employee Name</label>
                                <select class="select">
                                    <option>Select</option>
                                    <option>Anthony Lewis</option>
                                    <option>Brian Villalobos</option>
                                    <option>Harvey Smith</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="mb-3">
                                <label class="form-label">Leave Type</label>
                                <select class="select">
                                    <option>Select</option>
                                    <option>Medical Leave</option>
                                    <option>Casual Leave</option>
                                    <option>Annual Leave</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">From </label>
                                <div class="input-icon-end position-relative">
                                    <input type="text" class="form-control datetimepicker" placeholder="dd/mm/yyyy">
                                    <span class="input-icon-addon">
                                        <i class="ti ti-calendar text-gray-7"></i>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">To </label>
                                <div class="input-icon-end position-relative">
                                    <input type="text" class="form-control datetimepicker" placeholder="dd/mm/yyyy">
                                    <span class="input-icon-addon">
                                        <i class="ti ti-calendar text-gray-7"></i>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">No of Days</label>
                                <input type="text" class="form-control" disabled>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Remaining Days</label>
                                <input type="text" class="form-control" disabled>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="mb-3">
                                <label class="form-label">Reason</label>
                                <textarea class="form-control" rows="3"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light me-2" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Leaves</button>
                </div>
            </form>
        </div>
    </div>
</div>
<!-- /Add Leaves -->

</div>
<!-- /Main Wrapper -->

<!-- jQuery -->
<!-- <script data-cfasync="false" src="../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script> -->
<script src="/js/jquery-3.7.1.min.js"></script>
<!-- <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

<link href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" rel="stylesheet"> -->
<!-- Bootstrap Core JS -->
<script src="/js/bootstrap.bundle.min.js"></script>

<!-- Feather Icon JS -->
<script src="/js/feather.min.js"></script>

<!-- Slimscroll JS -->
<script src="/js/jquery.slimscroll.min.js"></script>

<!-- Chart JS -->
<script src="/plugins/apexchart/apexcharts.min.js"></script>
<script src="/plugins/apexchart/chart-data.js"></script>

<!-- Chart JS -->
<script src="/plugins/chartjs/chart.min.js"></script>
<script src="/plugins/chartjs/chart-data.js"></script>

<!-- Datetimepicker JS -->
<script src="/js/moment.min.js"></script>
<script src="/js/bootstrap-datetimepicker.min.js"></script>

<!-- Daterangepikcer JS -->
<script src="/plugins/daterangepicker/daterangepicker.js"></script>

<!-- Summernote JS -->
<script src="/plugins/summernote/summernote-lite.min.js"></script>

<!-- Bootstrap Tagsinput JS -->
<script src="/plugins/bootstrap-tagsinput/bootstrap-tagsinput.js"></script>

<!-- Select2 JS -->
<script src="/plugins/select2/js/select2.min.js"></script>

<!-- Color Picker JS -->
<script src="/plugins/%40simonwep/pickr/pickr.es5.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>


<!-- <script src="/socket.io/socket.io.js"></script> -->

<!-- Custom JS -->
<script> window.baseUrl = "<%= BASE_URL %>";</script>
<script src="/js/todo.js"></script>
<script src="/js/toast.js"></script>
<script src="/js/components/formatDate.js"></script>
<script src="/js/theme-colorpicker.js"></script>
<script src="/js/script.js"></script>
<script src="/js/pages/userRegister.js"></script>
<script src="/js/components/sidebar.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> -->
<script src="/js/utils.js"></script>
<script src="/js/pages/login.js"></script>
<script scr="/js/pages/projectList.js"></script>
<script src="/js/utils/constant.js"></script>

<!-- Share Document Modal -->
<div class="modal fade" id="sharedoc-modal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content custom-modal p-3">
            <div class="modal-header">
                <div class="mdhhdng_subhdng">
                    <h5 class="modal-title fw-bold">Share Document</h5>
                    <p>Invite the members to collaborate in this document</p>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">
                <!-- Time Duration -->
                <h6 class="fw-normal fs-20 mb-3">Time Duration</h6>
                <div class="d-flex flex-wrap gap-3 mb-4">
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="time" id="oneday">
                        <label class="form-check-label" for="oneday">One Day</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="time" id="onemonth">
                        <label class="form-check-label" for="onemonth">1 Month</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="time" id="oneweek">
                        <label class="form-check-label" for="oneweek">1 Week</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="time" id="lifetime">
                        <label class="form-check-label" for="lifetime">Lifetime</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="time" id="onetime">
                        <label class="form-check-label" for="onetime">One Time</label>
                    </div>
                    <div class="form-check position-relative">
                        <input class="form-check-input" type="radio" name="time" id="custom">
                        <label class="form-check-label rangelabel" for="custom">Custom <i
                                class="ti ti-calendar"></i></label>
                        <div id="customDateWrapper" style="display:none;">
                            <input type="text" class="form-control" placeholder="YYYY-MM-DD to YYYY-MM-DD"
                                id="flatpickr-range" />
                        </div>
                    </div>
                </div>

                <!-- Search User -->
                <div class="d-flex mb-4 gap-2">
                    <select id="userInviteSelect" class="form-select" style="width: 200px;"></select>
                    <select class="form-select" id="accessLevelSelect" style="width: 140px;">
                        <option value="view">View Only</option>
                        <option value="edit">Edit</option>
                    </select>
                    <button id="inviteUserBtn" class="site-btnmd">Invite</button>
                </div>

                <!-- People With Access -->
                <h6 class="fw-normal fs-20 mb-3">People With Access</h6>
                <div id="usersWithAccessContainer" class="mb-4"></div>

                <!-- General Access -->
                <h6 class="fw-normal fs-20 mb-3">General Access</h6>
                <div class="d-flex align-items-start justify-content-between mb-4">
                    <div class="icon_anyoneslct d-flex align-items-center gap-2">
                        <div class="icn">
                            <img src="/img/icons/link.png" alt="link icon">
                        </div>
                        <div class="anyone_txtwrp">
                            <select id="accessType" class="form-select w-auto mb-1">
                                <option value="anyone" selected>Anyone with the link</option>
                                <option value="restricted">Restricted</option>
                            </select>
                            <small class="fs-12" id="infoText">Anyone on the internet with the link can view</small>
                        </div>
                    </div>
                    <select id="roleType" class="form-select form-select-sm" style="width:120px;">
                        <option value="viewer" selected>Can View</option>
                        <option value="editor">Can Edit</option>
                    </select>
                </div>

                <!-- Share Link -->
                <div class="input-group mb-3 copygroup">
                    <input type="text" id="sharelink" class="form-control" value="https://duplextech.com/" readonly>
                    <button class="btn btncopylink" id="copyLinkBtn">
                        <i class="ti ti-copy"></i> Copy link
                    </button>
                </div>
            </div>

            <div class="modal-footer">
                <button class="site-btnmd" id="shareBtn">Done</button>
            </div>
        </div>
    </div>
</div>

<!-- Version modal -->

<div class="modal fade" id="versionhistory-modal" tabindex="-1" aria-labelledby="versionHistoryModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="versionHistoryModalLabel">Version History</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="search-bar mb-3">
                    <input type="text" class="form-control" placeholder="Search Version History">
                </div>
                <div class="version-list">
                    <div class="version-item">
                        <div class="dflexbtwn align-items-start">
                            <div class="flxtblleft">
                                <span class="avatar rounded bg-light mb-2">
                                    <img src="/img/icons/fn2.png">
                                </span>
                                <div class="flxtbltxt">
                                    <p class="fs-18 mb-1 fw-normal">Project Proposal v2.4</p>
                                    <span class="fs-16 fw-normal d-block mb-2">Modified by Arun Sharma </span>
                                    <h5 class="fs-18 fw-light text-black mb-3">Added New feature in the Document
                                    </h5>
                                    <div class="version-actions">
                                        <button class="site-btnmd fw-light">View</button>
                                        <button class="btn btn-outline-light rounded-pill">Restore to v2.4
                                            Version</button>
                                    </div>
                                </div>
                            </div>
                            <p>Modified on August 08, 2025</p>
                        </div>
                    </div>

                    <div class="version-item">
                        <div class="dflexbtwn align-items-start">
                            <div class="flxtblleft">
                                <span class="avatar rounded bg-light mb-2">
                                    <img src="/img/icons/fn2.png">
                                </span>
                                <div class="flxtbltxt">
                                    <p class="fs-18 mb-1 fw-normal">Project Proposal v2.4</p>
                                    <span class="fs-16 fw-normal d-block mb-2">Modified by Arun Sharma </span>
                                    <h5 class="fs-18 fw-light text-black mb-3">Added New feature in the Document
                                    </h5>
                                    <div class="version-actions">
                                        <button class="site-btnmd fw-light">View</button>
                                        <button class="btn btn-outline-light rounded-pill">Restore to v2.4
                                            Version</button>
                                    </div>
                                </div>
                            </div>
                            <p>Modified on August 08, 2025</p>
                        </div>
                    </div>

                    <div class="version-item">
                        <div class="dflexbtwn align-items-start">
                            <div class="flxtblleft">
                                <span class="avatar rounded bg-light mb-2">
                                    <img src="/img/icons/fn2.png">
                                </span>
                                <div class="flxtbltxt">
                                    <p class="fs-18 mb-1 fw-normal">Project Proposal v2.4</p>
                                    <span class="fs-16 fw-normal d-block mb-2">Modified by Arun Sharma </span>
                                    <h5 class="fs-18 fw-light text-black mb-3">Added New feature in the Document
                                    </h5>
                                    <div class="version-actions">
                                        <button class="site-btnmd fw-light">View</button>
                                        <button class="btn btn-outline-light rounded-pill">Restore to v2.4
                                            Version</button>
                                    </div>
                                </div>
                            </div>
                            <p>Modified on August 08, 2025</p>
                        </div>
                    </div>

                    <div class="version-item">
                        <div class="dflexbtwn align-items-start">
                            <div class="flxtblleft">
                                <span class="avatar rounded bg-light mb-2">
                                    <img src="/img/icons/fn2.png">
                                </span>
                                <div class="flxtbltxt">
                                    <p class="fs-18 mb-1 fw-normal">Project Proposal v2.4</p>
                                    <span class="fs-16 fw-normal d-block mb-2">Modified by Arun Sharma </span>
                                    <h5 class="fs-18 fw-light text-black mb-3">Added New feature in the Document
                                    </h5>
                                    <div class="version-actions">
                                        <button class="site-btnmd fw-light">View</button>
                                        <button class="btn btn-outline-light rounded-pill">Restore to v2.4
                                            Version</button>
                                    </div>
                                </div>
                            </div>
                            <p>Modified on August 08, 2025</p>
                        </div>
                    </div>




                </div>
            </div>
        </div>
    </div>
</div>

<!-- Download modal -->

<div class="modal fade" id="downloaddoc-modal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="border-radius:20px;">

            <!-- Header -->
            <div class="modal-header border-0">
                <h5 class="modal-title fw-medium fs-24 text-black" id="downloadModalTitle">
                    Download File
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <!-- Body -->
            <div class="modal-body">
                <div class="border rounded-3 p-3 d-flex">

                    <!-- File Icon -->
                    <span class="avatar avatar-xxxl rounded bg-light mb-2 p-2 me-4">
                        <img src="/img/icons/fn2big.png" id="downloadFileIcon">
                    </span>

                    <!-- File Info -->
                    <div class="flex-grow-1">
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="radio" name="fileOption" id="originalFile" checked>
                            <label class="form-check-label" for="originalFile" id="downloadFileLabel">
                                Original File <span class="text-muted d-block" id="downloadFileSize">(â€”)</span>
                            </label>
                        </div>
                        <button id="confirmDownload" class="btn btn-primary px-4 fw-normal rounded-pill">
                            Download
                        </button>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>


<!-- Thrashdoc modal -->

<div class="modal fade" id="trashdoc-modal" tabindex="-1" aria-labelledby="trashdocLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow p-3">
            <!-- Header -->
            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title fw-bold" id="trashdocLabel">
                    <img src="/img/icons/bin.png"> <br>
                    Move to Recycle Bin
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Body -->
            <div class="modal-body text-muted">
                Please confirm that you want to move the selected item(s) to the Recycle bin
            </div>

            <!-- Footer -->
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-light px-4 rounded-pill" data-bs-dismiss="modal">Cancel</button>
                <button type="button" id="confirm-trash-folder" class="btn btn-primary px-4 rounded-pill">Yes,
                    Move</button>
            </div>
        </div>
    </div>
</div>


<!-- Restore Modal -->
<div class="modal fade" id="restore-folder-modal" tabindex="-1" aria-labelledby="restoreFolderLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow p-3">
            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title fw-bold d-flex align-items-center" id="restoreFolderLabel">
                    <img src="/img/icons/restore.png" alt="Restore Icon" width="32" class="me-2">
                    Restore Folder
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-muted">
                Are you sure you want to restore this folder?
            </div>
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-light px-4 rounded-pill" data-bs-dismiss="modal">Cancel</button>
                <button type="button" id="confirm-restore-folder" class="btn btn-success px-4 rounded-pill">Yes,
                    Restore</button>
            </div>
        </div>
    </div>
</div>

<!-- Archivedoc modal -->

<div class="modal fade" id="archivedoc-modal" tabindex="-1" aria-labelledby="archivedocLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4 shadow p-3">
            <!-- Header -->
            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title fw-bold" id="archivedocLabel">
                    <img class="" src="/img/icons/archvbin.png"> <br>
                    Move to Archive
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Body -->
            <div class="modal-body text-muted">
                Are you sure you want to archive Proposal v2.4 ?
            </div>

            <!-- Footer -->
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-light px-4 rounded-pill" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" id="confirm-archive-folder" class="btn btn-primary px-4 rounded-pill">Yes,
                    Move</button>
            </div>
        </div>
    </div>
</div>

<!-- Folder Creation Modal -->
<div id="folder-modal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            <div class="modal-body">
                <h5>Create New Folder</h5>
                <form id="createFolderForm" class="mt-4 px-3">
                    <div class="mb-3">
                        <label for="folderName" class="form-label">Folder Name</label>
                        <input class="form-control" type="text" id="folderName" name="name" required
                            placeholder="Enter Folder Name">
                    </div>
                    <div class="mb-3">
                        <label for="parentFolder" class="form-label">Parent Folder</label>
                        <select id="parentFolder" class="form-control select2" style="width: 100%;">
                            <option value="">-- Root (No Parent) --</option>
                        </select>
                    </div>
                    <div class="mb-3 text-center">
                        <button class="btn btn-primary rounded-pill" type="submit">Create Folder</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!--Recyclbin all delete files modal  -->
<div class="modal fade" id="emptybin-modal" tabindex="-1" aria-labelledby="emptybinLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-md">
        <div class="modal-content rounded-4 shadow p-3">
            <!-- Header -->
            <div class="modal-header d-block border-0 pb-0">
                <img class="mb-3" src="/img/icons/bin.png">
                <h5 class="modal-title fw-bold" id="trashdocLabel">
                    Emptying the Recycle bin
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Body -->
            <div class="modal-body text-muted">
                Are you sure you want to permanently <span class="txtblue"> delete all files </span> in the recycle
                bin
                (111MB)? This action cannot be undone
            </div>

            <!-- Footer -->
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-light px-4 rounded-pill" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-primary px-4 rounded-pill">Yes, Delete</button>
            </div>
        </div>
    </div>
</div>

<!--Recyclbin single delete file modal  -->
<div class="modal fade" id="fileDelete-modal" tabindex="-1" aria-labelledby="fileDeleteLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-md">
        <div class="modal-content rounded-4 shadow p-3">

            <!-- Header -->
            <div class="modal-header d-flex align-items-center justify-content-between border-0 pb-0">
                <div class="d-flex align-items-center">
                    <img class="me-3" src="/img/icons/bin.png" alt="Bin Icon">

                    <div class="d-flex align-items-center">
                        <span class="avatar rounded bg-light me-2">
                            <img src="/img/icons/fn1.png" alt="File Icon">
                        </span>
                        <div class="flxtbltxt">
                            <p class="fs-14 mb-1 fw-normal text-neutral">
                                Project Proposal v1
                                <span class="text-success">+2</span>
                            </p>
                            <span class="fs-11 fw-light text-black">190KB</span>
                        </div>
                    </div>
                </div>

                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Body -->
            <h5 class="mt-3">
                Are you sure you want to permanently delete this file?
            </h5>
            <div class="modal-body text-muted">
                Once the file is deleted from the recycle bin it cannot be retrieved.
            </div>

            <!-- Footer -->
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-light px-4 rounded-pill" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-primary px-4 rounded-pill">Delete Permanently</button>
            </div>
        </div>
    </div>
</div>



<!--Restore files modal  -->
<div class="modal fade" id="restore-modal" tabindex="-1" aria-labelledby="restoremodalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-md">
        <div class="modal-content rounded-4 shadow p-3">

            <!-- Header -->
            <div class="modal-header d-flex align-items-center justify-content-between border-0 pb-0">
                <div class="d-flex align-items-center">
                    <img class="me-3" src="/img/icons/bin.png" alt="Restore Icon">

                    <div class="d-flex align-items-center">
                        <span class="avatar rounded bg-light me-2">
                            <img src="/img/icons/fn1.png" alt="File Icon">
                        </span>
                        <div class="flxtbltxt">
                            <p class="fs-14 mb-1 fw-normal text-neutral">
                                Project Proposal v1
                                <span class="text-success">+2</span>
                            </p>
                            <span class="fs-11 fw-light text-black">190KB</span>
                        </div>
                    </div>
                </div>

                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Body -->
            <h5 class="mt-3">
                Are you sure you want to Restore the file?
            </h5>
            <div class="modal-body text-muted">
                The file will be restore to its original destination
            </div>

            <!-- Footer -->
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-light px-4 rounded-pill" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-primary px-4 rounded-pill">Yes, Restore</button>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        const $headerProjectSelect = $('#selectHeaderProject');

        if ($headerProjectSelect.length) {
            $headerProjectSelect.select2({
                placeholder: 'Select project',
                allowClear: true,
                width: '200px',
                ajax: {
                    url: `${baseUrl}/api/projects`,
                    dataType: 'json',
                    delay: 250,
                    data: function (params) {
                        return {
                            search: params.term || '',
                            page: params.page || 1,
                            limit: 10
                        };
                    },
                    processResults: function (data) {
                        return {
                            results: (data.data || []).map(p => ({
                                id: p._id,
                                text: p.projectName || p.name
                            }))
                        };
                    },
                    cache: true
                }
            });

            $headerProjectSelect.on('select2:select select2:unselect', async function () {
                const projectId = $(this).val();
                const projectName = $(this).find('option:selected').text();

                try {
                    const res = await fetch(`${baseUrl}/api/session/project`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        credentials: 'include',
                        body: JSON.stringify({
                            projectId: projectId || null,
                            projectName: projectName || ''
                        })
                    });

                    if (!res.ok) throw new Error('Failed to save project selection');

                    if (projectId) {
                        $('#currentProjectName').text(projectName);

                        // ADD THESE LINES
                        window.selectedProjectId = projectId;
                        window.selectedProjectName = projectName;
                        loadFolders(null, [], projectId); // Load folders immediately
                        // location.reload(); // Optional â€” remove if AJAX load is enough
                    } else {
                        $('#currentProjectName').text('No project selected');
                    }


                    // Reload page after session is updated
                    location.reload();

                } catch (err) {
                    console.error('Error saving project selection:', err);
                }
            });

            // Load saved project on page load
            (async function loadSavedProject() {
                try {
                    const res = await fetch(`${baseUrl}/api/session/project`, { credentials: 'include' });
                    const data = await res.json();

                    if (data.selectedProject) {
                        // Set globals so your folder UI recognizes the selected project
                        window.selectedProjectId = data.selectedProject;
                        window.selectedProjectName = data.selectedProjectName;

                        // Ensure the option exists in the dropdown
                        if (!$headerProjectSelect.find(`option[value="${data.selectedProject}"]`).length) {
                            const option = new Option(data.selectedProjectName, data.selectedProject, true, true);
                            $headerProjectSelect.append(option).trigger('change');
                        }

                        // Auto load folders on page load!
                        loadFolders(null, [], data.selectedProject);
                    }
                } catch (err) {
                    console.error('Error loading saved project:', err);
                }
            })();
        }
    });

    // ...existing code...
    // (async function loadSavedProject() {
    //     try {
    //         // Use relative path to avoid protocol/domain mismatch (prevents HTML redirect responses)
    //         const res = await fetch('/api/session/project', { credentials: 'include' });

    //         // If server redirected to an HTML page (login), content-type will not be JSON
    //         const contentType = res.headers.get('content-type') || '';
    //         if (!res.ok) {
    //             // If unauthorized, reset UI and stop
    //             if (res.status === 401) {
    //                 console.warn('Not authenticated when loading saved project');
    //                 $('#currentProjectName').text('No project selected');
    //                 return;
    //             }
    //             // For other errors try to log server response for debugging
    //             const text = await res.text();
    //             console.error('Failed loading saved project:', res.status, text);
    //             return;
    //         }

    //         if (!contentType.includes('application/json')) {
    //             // Server returned HTML (likely a redirect to login or an error page)
    //             const text = await res.text();
    //             console.error('Expected JSON but got:', text.slice(0, 200));
    //             return;
    //         }

    //         const data = await res.json();

    //         if (data && data.selectedProject) {
    //             window.selectedProjectId = data.selectedProject;
    //             window.selectedProjectName = data.selectedProjectName;

    //             if (!$headerProjectSelect.find(`option[value="${data.selectedProject}"]`).length) {
    //                 const option = new Option(data.selectedProjectName, data.selectedProject, true, true);
    //                 $headerProjectSelect.append(option).trigger('change');
    //             }

    //             // Auto load folders on page load using the project id
    //             if (typeof loadFolders === 'function') {
    //                 try {
    //                     loadFolders(null, [], data.selectedProject);
    //                 } catch (err) {
    //                     console.error('loadFolders failed:', err);
    //                 }
    //             }
    //         }
    //     } catch (err) {
    //         // If fetch throws, log entire error (network/CORS/etc.)
    //         console.error('Error loading saved project:', err);
    //     }
    // })();
</script>

<script>$(document).ready(function () {
        $('#sharedoc-modal').on('shown.bs.modal', function () {
            flatpickr('#flatpickr-range', {
                mode: 'range',
                dateFormat: 'd-m-Y',
                appendTo: this, // attach to current modal
            });
        });

        // Prevent Bootstrap from blocking Flatpickr focus
        $('#shareDocumentModal').on('focusin', function (e) {
            if ($(e.target).closest('.flatpickr-calendar').length) {
                e.stopPropagation();
            }
        });
    });</script>
<script>
    $(document).ready(function () {
        const baseUrl = window.baseUrl;
        let currentDocId = null;

        // Initialize Select2
        $('#userInviteSelect').select2({
            placeholder: "Select user or enter email",
            allowClear: true,
            width: 'resolve', // respects the container width
            dropdownParent: $('#sharedoc-modal'), // ensures dropdown stays inside modal
            ajax: {
                url: `${baseUrl}/api/user/search`,
                dataType: 'json',
                delay: 250,
                data: params => ({ search: params.term }),
                processResults: data => ({
                    results: (data.users || []).map(u => ({
                        id: u.email,
                        text: `${u.name}`,
                        isNew: false
                    }))
                })
            },
            tags: true,
            createTag: function (params) {
                const email = params.term.trim();
                if (/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                    return { id: email, text: email, isNew: true };
                }
                return null;
            },
            minimumInputLength: 0
        });


        // // Show Share Modal
        // $('#sharedoc-modal').on('show.bs.modal', function (event) {
        //     currentDocId = $(event.relatedTarget).data('doc-id');
        //     if (!currentDocId) return showToast('Error: No document selected', 'info');

        //     const modal = $(this);
        //     modal.find('input[type="text"]').val('');
        //     modal.find('select').val('view').trigger('change');
        //     modal.find('#customDateWrapper').hide();
        //     modal.find('input[type="radio"]').prop('checked', false);
        //     modal.find('#lifetime').prop('checked', true);
        //     modal.find('.user-accssrow.dynamic').remove();

        //     loadSharedUsers(currentDocId, modal);
        // });

        // // Toggle custom duration
        // $('#sharedoc-modal input[name="time"]').on('change', function () {
        //     const isCustom = $(this).attr('id') === 'custom';
        //     $('#customDateWrapper').toggle(isCustom);
        //     if (isCustom) {
        //         const today = new Date().toISOString().split('T')[0];
        //         $('#startDate').val(today);
        //         $('#endDate').attr('min', today);
        //     }
        // });

        // // Load shared users from API
        // function loadSharedUsers(docId, modal) {
        //     $.ajax({
        //         url: `${baseUrl}/api/documents/${docId}`,
        //         method: 'GET',
        //         success: function (res) {
        //             if (!res.success || !res.document) return console.error('Failed to load document');

        //             const sharedWith = res.document.sharedWith || [];
        //             const wrapper = modal.find('.modal-body');
        //             wrapper.find('.user-accssrow.dynamic').remove();

        //             sharedWith.forEach(sw => {
        //                 if (sw.user && sw.user.email) {
        //                     const row = `
        //                 <div class="user-accssrow dynamic" data-user-id="${sw.user._id}">
        //                     <div class="empname_eml">
        //                         <div class="fw-normal fs-18">${sw.user.name || sw.user.email}</div>
        //                         <small class="fs-16">${sw.user.email}</small>
        //                         <small class="badge bg-${sw.inviteStatus === 'accepted' ? 'success' : 'warning'}">
        //                             ${sw.inviteStatus}
        //                         </small>
        //                     </div>
        //                     <div class="d-flex align-items-center gap-4">
        //                         <select class="form-select form-select-sm access-level" style="width:100px;">
        //                             <option value="view" ${sw.accessLevel === 'view' ? 'selected' : ''}>View</option>
        //                             <option value="edit" ${sw.accessLevel === 'edit' ? 'selected' : ''}>Edit</option>
        //                         </select>
        //                         <button class="btn btn-sm btn-outline-danger remove-user">Remove</button>
        //                     </div>
        //                 </div>`;
        //                     wrapper.append(row);
        //                 }
        //             });
        //         },
        //         error: function (xhr, status, error) {
        //             console.error('Error loading shared users:', error);
        //         }
        //     });
        // }

        // // Add user to UI dynamically
        // function addUserToUI(email, accessLevel, isPending = true) {
        //     const wrapper = $('#sharedoc-modal .modal-body');
        //     const row = `
        // <div class="user-accssrow dynamic" data-user-email="${email}">
        //     <div class="empname_eml">
        //         <div class="fw-normal fs-18">${email.split('@')[0]}</div>
        //         <small class="fs-16">${email}</small>
        //         <small class="badge bg-warning">pending</small>
        //     </div>
        //     <div class="d-flex align-items-center gap-4">
        //         <select class="form-select form-select-sm access-level" style="width:100px;">
        //             <option value="view" ${accessLevel === 'view' ? 'selected' : ''}>View</option>
        //             <option value="edit" ${accessLevel === 'edit' ? 'selected' : ''}>Edit</option>
        //         </select>
        //         <button class="btn btn-sm btn-outline-danger remove-user">Remove</button>
        //     </div>
        // </div>`;
        //     wrapper.append(row);
        // }
    });
</script>

<script>
    document.querySelectorAll('input[name="time"]').forEach(radio => {
        radio.addEventListener('change', function () {
            if (this.id === "custom") {
                document.getElementById("customDateWrapper").style.display = "flex";
                document.getElementsByClassName("rangelabel")[0].style.display = "none";
            } else {
                document.getElementById("customDateWrapper").style.display = "none";
                document.getElementsByClassName("rangelabel")[0].style.display = "block";
            }
        });
    });

    const accessType = document.getElementById("accessType");
    const roleType = document.getElementById("roleType");

    accessType.addEventListener("change", function () {
        if (this.value === "anyone") {
            roleType.classList.remove("d-none"); // show role dropdown
            infoText.textContent = "Anyone on the internet with the link can view";
        } else {
            roleType.classList.add("d-none"); // hide role dropdown
            infoText.textContent = "Only people with access can open this link";
        }
    });


</script>

</body>

</html>